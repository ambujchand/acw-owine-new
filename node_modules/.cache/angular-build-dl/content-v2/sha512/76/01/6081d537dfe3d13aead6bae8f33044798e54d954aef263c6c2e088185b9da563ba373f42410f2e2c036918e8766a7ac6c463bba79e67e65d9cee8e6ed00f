(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{X3zk:function(t,o,e){"use strict";e.r(o),e.d(o,"LoginPageModule",(function(){return S}));var i=e("ofXK"),s=e("3Pt+"),r=e("TEn/"),n=e("tyNb"),a=e("mrSG"),l=e("jUet"),c=e("fXoL"),d=e("3LUQ"),g=e("XNvx"),h=e("tk/3"),p=e("5zL6");let b=(()=>{class t{constructor(t,o){this.http=t,this.env=o}isSession(){return JSON.parse(localStorage.getItem("user"))}}return t.\u0275fac=function(o){return new(o||t)(c.Ob(h.a),c.Ob(p.a))},t.\u0275prov=c.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var u=e("8ijX");const m=[{path:"",component:(()=>{class t{constructor(t,o,e,i,r,n,a,l,c){this.loading=t,this.formBuilder=o,this.router=e,this.loginService=i,this.platform=r,this.routerOutlet=n,this.app=a,this.modalController=l,this.shop=c,this.loginForm=this.formBuilder.group({email:["",[s.k.required]],password:["",s.k.required]}),this.ifLogin=JSON.parse(localStorage.getItem("user")),this.ifShop=JSON.parse(localStorage.getItem("shop")),console.log(this.ifLogin),this.platform.backButton.subscribe(()=>{this.router.navigateByUrl("/deshboard")})}presentModal(){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.modalController.create({component:l.a,cssClass:"my-custom-class"});return yield t.present()}))}ionViewWillEnter(){null!=this.ifLogin&&(null!=this.ifShop?this.router.navigateByUrl("/deshboard"):(console.log(this.ifLogin),0==this.ifLogin.user.role||1==this.ifLogin.user.role||2==this.ifLogin.user.role?this.getShop():this.shopBelongsToUser()))}shopBelongsToUser(){this.loading.present(),this.shop.getShop().subscribe(t=>{console.log(t.data),this.loading.dismiss(),localStorage.setItem("shop",JSON.stringify({id:t.data})),this.router.navigateByUrl("/deshboard")},t=>{0==t.status?(this.loading.dismiss(),this.loading.presentToastWarning("check your internet connection.")):500==t.status&&(this.loading.dismiss(),this.loading.presentToastError("Server error."))})}getShop(){this.loading.present(),this.shop.getShop().subscribe(t=>{console.log(t.data),0==t.data.length?(this.presentModal(),this.loading.dismiss()):(this.loading.dismiss(),localStorage.setItem("shop",JSON.stringify({id:t.data})),this.router.navigateByUrl("/deshboard"))},t=>{0==t.status?(this.loading.dismiss(),this.loading.presentToastWarning("check your internet connection.")):500==t.status&&(this.loading.dismiss(),this.loading.presentToastError("Server error."))})}login(){this.loading.present(),this.loginService.login(this.loginForm.value.email,this.loginForm.value.password).subscribe(t=>{this.userDetails=t,console.log(t),this.userDetails.user&&(localStorage.setItem("user",JSON.stringify({user:this.userDetails.user,token_type:this.userDetails.token_type,access_token:this.userDetails.access_token,sidebar:this.userDetails.sidebar})),this.app.ifLogin=JSON.parse(localStorage.getItem("user")),this.loading.dismiss(),window.location.reload(),this.router.navigateByUrl("/")),this.userDetails.error&&(this.loading.dismiss(),this.loading.presentToastWarning(this.userDetails.error))},t=>{0==t.status?(this.loading.presentToastWarning("check your internet connection."),this.loading.dismiss()):500==t.status&&(this.loading.dismiss(),this.loading.presentToastError("Server error."))})}doRefresh(t){console.log("Begin async operation"),setTimeout(()=>{console.log("Async operation has ended"),t.target.complete()},2e3)}ngOnInit(){}}return t.\u0275fac=function(o){return new(o||t)(c.Hb(d.a),c.Hb(s.a),c.Hb(n.g),c.Hb(g.a),c.Hb(r.X),c.Hb(r.H),c.Hb(b),c.Hb(r.U),c.Hb(u.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-login"]],decls:23,vars:3,consts:[[3,"translucent"],["padding","true"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Pull to refresh","refreshingSpinner","circles"],[1,"p-0"],["size","2"],["src","assets/login.jpg"],[2,"padding","0px","border","1px solid #151414"],[3,"formGroup","ngSubmit"],["type","text","formControlName","email","placeholder","Email or Phone"],["type","password","formControlName","password","placeholder","Password"],["type","submit","expand","block",3,"disabled"]],template:function(t,o){1&t&&(c.Kb(0,"ion-header",0),c.Kb(1,"ion-toolbar"),c.Kb(2,"ion-title"),c.jc(3,"Login"),c.Jb(),c.Jb(),c.Jb(),c.Kb(4,"ion-content",1),c.Kb(5,"ion-refresher",2),c.Sb("ionRefresh",(function(t){return o.doRefresh(t)})),c.Ib(6,"ion-refresher-content",3),c.Jb(),c.Kb(7,"ion-grid",4),c.Kb(8,"ion-row"),c.Ib(9,"ion-col",5),c.Kb(10,"ion-col"),c.Ib(11,"img",6),c.Jb(),c.Ib(12,"ion-col",5),c.Jb(),c.Jb(),c.Kb(13,"ion-card"),c.Kb(14,"ion-card-content",7),c.Kb(15,"form",8),c.Sb("ngSubmit",(function(){return o.login()})),c.Kb(16,"ion-list",4),c.Kb(17,"ion-item"),c.Ib(18,"ion-input",9),c.Jb(),c.Kb(19,"ion-item"),c.Ib(20,"ion-input",10),c.Jb(),c.Jb(),c.Kb(21,"ion-button",11),c.jc(22,"Login"),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb()),2&t&&(c.Zb("translucent",!0),c.xb(15),c.Zb("formGroup",o.loginForm),c.xb(6),c.Zb("disabled",!o.loginForm.valid))},directives:[r.p,r.Q,r.P,r.k,r.F,r.G,r.o,r.I,r.j,r.e,r.f,s.l,s.h,s.c,r.z,r.u,r.t,r.ab,s.g,s.b,r.c],styles:["toast-wrapper[_ngcontent-%COMP%]   toast-bottom[_ngcontent-%COMP%]{bottom:calc(8px + var(--ion-safe-area-bottom, 0px));border-radius:25px;height:25px;border-radius:2px solid red;border:1px solid red;text-align:center;font-size:12px}ion-toast[_ngcontent-%COMP%]{color:red!important}.toast-container[_ngcontent-%COMP%], toast-container[_ngcontent-%COMP%]{background:#fff!important;color:red!important}ion-toast[_ngcontent-%COMP%]{border-radius:.65rem!important;background:#fff!important}.toast-md[_ngcontent-%COMP%], toast-md[_ngcontent-%COMP%]{background:#fff!important;color:red!important}"]}),t})()}];let f=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(o){return new(o||t)},imports:[[n.i.forChild(m)],n.i]}),t})(),S=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(o){return new(o||t)},imports:[[s.j,n.i,h.b,i.b,r.R,f]]}),t})()}}]);