!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{X3zk:function(t,n,i){"use strict";i.r(n),i.d(n,"LoginPageModule",(function(){return O}));var r,s,a,l,c=i("ofXK"),u=i("3Pt+"),d=i("TEn/"),g=i("tyNb"),p=i("mrSG"),b=i("jUet"),f=i("fXoL"),h=i("3LUQ"),m=i("XNvx"),v=i("tk/3"),y=i("5zL6"),S=((r=function(){function t(o,n){e(this,t),this.http=o,this.env=n}return o(t,[{key:"isSession",value:function(){return JSON.parse(localStorage.getItem("user"))}}]),t}()).\u0275fac=function(e){return new(e||r)(f.Ob(v.a),f.Ob(y.a))},r.\u0275prov=f.Db({token:r,factory:r.\u0275fac,providedIn:"root"}),r),k=i("8ijX"),w=[{path:"",component:(s=function(){function t(o,n,i,r,s,a,l,c,d){var g=this;e(this,t),this.loading=o,this.formBuilder=n,this.router=i,this.loginService=r,this.platform=s,this.routerOutlet=a,this.app=l,this.modalController=c,this.shop=d,this.loginForm=this.formBuilder.group({email:["",[u.j.required]],password:["",u.j.required]}),this.ifLogin=JSON.parse(localStorage.getItem("user")),this.ifShop=JSON.parse(localStorage.getItem("shop")),console.log(this.ifLogin),this.platform.backButton.subscribe((function(){g.router.navigateByUrl("/deshboard")}))}return o(t,[{key:"presentModal",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({component:b.a,cssClass:"my-custom-class"});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"ionViewWillEnter",value:function(){null!=this.ifLogin&&(null!=this.ifShop?this.router.navigateByUrl("/deshboard"):(console.log(this.ifLogin),0==this.ifLogin.user.role||1==this.ifLogin.user.role||2==this.ifLogin.user.role?this.getShop():this.shopBelongsToUser()))}},{key:"shopBelongsToUser",value:function(){var e=this;this.loading.present(),this.shop.getShop().subscribe((function(t){console.log(t.data),e.loading.dismiss(),localStorage.setItem("shop",JSON.stringify({id:t.data})),e.router.navigateByUrl("/deshboard")}),(function(t){0==t.status?(e.loading.dismiss(),e.loading.presentToastWarning("check your internet connection.")):500==t.status&&(e.loading.dismiss(),e.loading.presentToastError("Server error."))}))}},{key:"getShop",value:function(){var e=this;this.loading.present(),this.shop.getShop().subscribe((function(t){console.log(t.data),0==t.data.length?(e.presentModal(),e.loading.dismiss()):(e.loading.dismiss(),localStorage.setItem("shop",JSON.stringify({id:t.data})),e.router.navigateByUrl("/deshboard"))}),(function(t){0==t.status?(e.loading.dismiss(),e.loading.presentToastWarning("check your internet connection.")):500==t.status&&(e.loading.dismiss(),e.loading.presentToastError("Server error."))}))}},{key:"login",value:function(){var e=this;this.loading.present(),this.loginService.login(this.loginForm.value.email,this.loginForm.value.password).subscribe((function(t){e.userDetails=t,console.log(t),e.userDetails.user&&(localStorage.setItem("user",JSON.stringify({user:e.userDetails.user,token_type:e.userDetails.token_type,access_token:e.userDetails.access_token,sidebar:e.userDetails.sidebar})),e.app.ifLogin=JSON.parse(localStorage.getItem("user")),e.loading.dismiss(),window.location.reload(),e.router.navigateByUrl("/")),e.userDetails.error&&(e.loading.dismiss(),e.loading.presentToastWarning(e.userDetails.error))}),(function(t){0==t.status?(e.loading.presentToastWarning("check your internet connection."),e.loading.dismiss()):500==t.status&&(e.loading.dismiss(),e.loading.presentToastError("Server error."))}))}},{key:"doRefresh",value:function(e){console.log("Begin async operation"),setTimeout((function(){console.log("Async operation has ended"),e.target.complete()}),2e3)}},{key:"ngOnInit",value:function(){}}]),t}(),s.\u0275fac=function(e){return new(e||s)(f.Hb(h.a),f.Hb(u.a),f.Hb(g.g),f.Hb(m.a),f.Hb(d.U),f.Hb(d.E),f.Hb(S),f.Hb(d.R),f.Hb(k.a))},s.\u0275cmp=f.Bb({type:s,selectors:[["app-login"]],decls:23,vars:3,consts:[[3,"translucent"],["padding","true"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Pull to refresh","refreshingSpinner","circles"],[1,"p-0"],["size","2"],["src","assets/login.jpg"],[2,"padding","0px","border","1px solid #151414"],[3,"formGroup","ngSubmit"],["type","text","formControlName","email","placeholder","Email or Phone"],["type","password","formControlName","password","placeholder","Password"],["type","submit","expand","block",3,"disabled"]],template:function(e,t){1&e&&(f.Kb(0,"ion-header",0),f.Kb(1,"ion-toolbar"),f.Kb(2,"ion-title"),f.hc(3,"Login"),f.Jb(),f.Jb(),f.Jb(),f.Kb(4,"ion-content",1),f.Kb(5,"ion-refresher",2),f.Sb("ionRefresh",(function(e){return t.doRefresh(e)})),f.Ib(6,"ion-refresher-content",3),f.Jb(),f.Kb(7,"ion-grid",4),f.Kb(8,"ion-row"),f.Ib(9,"ion-col",5),f.Kb(10,"ion-col"),f.Ib(11,"img",6),f.Jb(),f.Ib(12,"ion-col",5),f.Jb(),f.Jb(),f.Kb(13,"ion-card"),f.Kb(14,"ion-card-content",7),f.Kb(15,"form",8),f.Sb("ngSubmit",(function(){return t.login()})),f.Kb(16,"ion-list",4),f.Kb(17,"ion-item"),f.Ib(18,"ion-input",9),f.Jb(),f.Kb(19,"ion-item"),f.Ib(20,"ion-input",10),f.Jb(),f.Jb(),f.Kb(21,"ion-button",11),f.hc(22,"Login"),f.Jb(),f.Jb(),f.Jb(),f.Jb(),f.Jb()),2&e&&(f.Xb("translucent",!0),f.xb(15),f.Xb("formGroup",t.loginForm),f.xb(6),f.Xb("disabled",!t.loginForm.valid))},directives:[d.m,d.N,d.M,d.i,d.C,d.D,d.l,d.F,d.h,d.d,d.e,u.k,u.h,u.c,d.w,d.r,d.q,d.X,u.g,u.b,d.b],styles:["toast-wrapper[_ngcontent-%COMP%]   toast-bottom[_ngcontent-%COMP%]{bottom:calc(8px + var(--ion-safe-area-bottom, 0px));border-radius:25px;height:25px;border-radius:2px solid red;border:1px solid red;text-align:center;font-size:12px}ion-toast[_ngcontent-%COMP%]{color:red!important}.toast-container[_ngcontent-%COMP%], toast-container[_ngcontent-%COMP%]{background:#fff!important;color:red!important}ion-toast[_ngcontent-%COMP%]{border-radius:.65rem!important;background:#fff!important}.toast-md[_ngcontent-%COMP%], toast-md[_ngcontent-%COMP%]{background:#fff!important;color:red!important}"]}),s)}],J=((l=function t(){e(this,t)}).\u0275mod=f.Fb({type:l}),l.\u0275inj=f.Eb({factory:function(e){return new(e||l)},imports:[[g.i.forChild(w)],g.i]}),l),O=((a=function t(){e(this,t)}).\u0275mod=f.Fb({type:a}),a.\u0275inj=f.Eb({factory:function(e){return new(e||a)},imports:[[u.i,g.i,v.b,c.b,d.O,J]]}),a)}}])}();