!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{X3zk:function(e,n,r){"use strict";r.r(n),r.d(n,"LoginPageModule",(function(){return O}));var i,s,a,l,c=r("ofXK"),u=r("3Pt+"),d=r("TEn/"),g=r("tyNb"),p=r("mrSG"),b=r("jUet"),f=r("fXoL"),h=r("3LUQ"),m=r("XNvx"),v=r("tk/3"),y=r("5zL6"),S=((i=function(){function e(o,n){t(this,e),this.http=o,this.env=n}return o(e,[{key:"isSession",value:function(){return JSON.parse(localStorage.getItem("user"))}}]),e}()).\u0275fac=function(t){return new(t||i)(f.Ob(v.a),f.Ob(y.a))},i.\u0275prov=f.Db({token:i,factory:i.\u0275fac,providedIn:"root"}),i),k=r("8ijX"),w=[{path:"",component:(s=function(){function e(o,n,r,i,s,a,l,c,d){var g=this;t(this,e),this.loading=o,this.formBuilder=n,this.router=r,this.loginService=i,this.platform=s,this.routerOutlet=a,this.app=l,this.modalController=c,this.shop=d,this.loginForm=this.formBuilder.group({email:["",[u.k.required]],password:["",u.k.required]}),this.ifLogin=JSON.parse(localStorage.getItem("user")),this.ifShop=JSON.parse(localStorage.getItem("shop")),console.log(this.ifLogin),this.platform.backButton.subscribe((function(){g.router.navigateByUrl("/deshboard")}))}return o(e,[{key:"presentModal",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:b.a,cssClass:"my-custom-class"});case 2:return e=t.sent,t.next=5,e.present();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"ionViewWillEnter",value:function(){null!=this.ifLogin&&(null!=this.ifShop?this.router.navigateByUrl("/deshboard"):(console.log(this.ifLogin),0==this.ifLogin.user.role||1==this.ifLogin.user.role||2==this.ifLogin.user.role?this.getShop():this.shopBelongsToUser()))}},{key:"shopBelongsToUser",value:function(){var t=this;this.loading.present(),this.shop.getShop().subscribe((function(e){console.log(e.data),t.loading.dismiss(),localStorage.setItem("shop",JSON.stringify({id:e.data})),t.router.navigateByUrl("/deshboard")}),(function(e){0==e.status?(t.loading.dismiss(),t.loading.presentToastWarning("check your internet connection.")):500==e.status&&(t.loading.dismiss(),t.loading.presentToastError("Server error."))}))}},{key:"getShop",value:function(){var t=this;this.loading.present(),this.shop.getShop().subscribe((function(e){console.log(e.data),0==e.data.length?(t.presentModal(),t.loading.dismiss()):(t.loading.dismiss(),localStorage.setItem("shop",JSON.stringify({id:e.data})),t.router.navigateByUrl("/deshboard"))}),(function(e){0==e.status?(t.loading.dismiss(),t.loading.presentToastWarning("check your internet connection.")):500==e.status&&(t.loading.dismiss(),t.loading.presentToastError("Server error."))}))}},{key:"login",value:function(){var t=this;this.loading.present(),this.loginService.login(this.loginForm.value.email,this.loginForm.value.password).subscribe((function(e){t.userDetails=e,console.log(e),t.userDetails.user&&(localStorage.setItem("user",JSON.stringify({user:t.userDetails.user,token_type:t.userDetails.token_type,access_token:t.userDetails.access_token,sidebar:t.userDetails.sidebar})),t.app.ifLogin=JSON.parse(localStorage.getItem("user")),t.loading.dismiss(),window.location.reload(),t.router.navigateByUrl("/")),t.userDetails.error&&(t.loading.dismiss(),t.loading.presentToastWarning(t.userDetails.error))}),(function(e){0==e.status?(t.loading.presentToastWarning("check your internet connection."),t.loading.dismiss()):500==e.status&&(t.loading.dismiss(),t.loading.presentToastError("Server error."))}))}},{key:"doRefresh",value:function(t){console.log("Begin async operation"),setTimeout((function(){console.log("Async operation has ended"),t.target.complete()}),2e3)}},{key:"ngOnInit",value:function(){}}]),e}(),s.\u0275fac=function(t){return new(t||s)(f.Hb(h.a),f.Hb(u.a),f.Hb(g.g),f.Hb(m.a),f.Hb(d.X),f.Hb(d.H),f.Hb(S),f.Hb(d.U),f.Hb(k.a))},s.\u0275cmp=f.Bb({type:s,selectors:[["app-login"]],decls:23,vars:3,consts:[[3,"translucent"],["padding","true"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Pull to refresh","refreshingSpinner","circles"],[1,"p-0"],["size","2"],["src","assets/login.jpg"],[2,"padding","0px","border","1px solid #151414"],[3,"formGroup","ngSubmit"],["type","text","formControlName","email","placeholder","Email or Phone"],["type","password","formControlName","password","placeholder","Password"],["type","submit","expand","block",3,"disabled"]],template:function(t,e){1&t&&(f.Kb(0,"ion-header",0),f.Kb(1,"ion-toolbar"),f.Kb(2,"ion-title"),f.jc(3,"Login"),f.Jb(),f.Jb(),f.Jb(),f.Kb(4,"ion-content",1),f.Kb(5,"ion-refresher",2),f.Sb("ionRefresh",(function(t){return e.doRefresh(t)})),f.Ib(6,"ion-refresher-content",3),f.Jb(),f.Kb(7,"ion-grid",4),f.Kb(8,"ion-row"),f.Ib(9,"ion-col",5),f.Kb(10,"ion-col"),f.Ib(11,"img",6),f.Jb(),f.Ib(12,"ion-col",5),f.Jb(),f.Jb(),f.Kb(13,"ion-card"),f.Kb(14,"ion-card-content",7),f.Kb(15,"form",8),f.Sb("ngSubmit",(function(){return e.login()})),f.Kb(16,"ion-list",4),f.Kb(17,"ion-item"),f.Ib(18,"ion-input",9),f.Jb(),f.Kb(19,"ion-item"),f.Ib(20,"ion-input",10),f.Jb(),f.Jb(),f.Kb(21,"ion-button",11),f.jc(22,"Login"),f.Jb(),f.Jb(),f.Jb(),f.Jb(),f.Jb()),2&t&&(f.Zb("translucent",!0),f.xb(15),f.Zb("formGroup",e.loginForm),f.xb(6),f.Zb("disabled",!e.loginForm.valid))},directives:[d.p,d.Q,d.P,d.k,d.F,d.G,d.o,d.I,d.j,d.e,d.f,u.l,u.h,u.c,d.z,d.u,d.t,d.ab,u.g,u.b,d.c],styles:["toast-wrapper[_ngcontent-%COMP%]   toast-bottom[_ngcontent-%COMP%]{bottom:calc(8px + var(--ion-safe-area-bottom, 0px));border-radius:25px;height:25px;border-radius:2px solid red;border:1px solid red;text-align:center;font-size:12px}ion-toast[_ngcontent-%COMP%]{color:red!important}.toast-container[_ngcontent-%COMP%], toast-container[_ngcontent-%COMP%]{background:#fff!important;color:red!important}ion-toast[_ngcontent-%COMP%]{border-radius:.65rem!important;background:#fff!important}.toast-md[_ngcontent-%COMP%], toast-md[_ngcontent-%COMP%]{background:#fff!important;color:red!important}"]}),s)}],J=((l=function e(){t(this,e)}).\u0275mod=f.Fb({type:l}),l.\u0275inj=f.Eb({factory:function(t){return new(t||l)},imports:[[g.i.forChild(w)],g.i]}),l),O=((a=function e(){t(this,e)}).\u0275mod=f.Fb({type:a}),a.\u0275inj=f.Eb({factory:function(t){return new(t||a)},imports:[[u.j,g.i,v.b,c.b,d.R,J]]}),a)}}])}();