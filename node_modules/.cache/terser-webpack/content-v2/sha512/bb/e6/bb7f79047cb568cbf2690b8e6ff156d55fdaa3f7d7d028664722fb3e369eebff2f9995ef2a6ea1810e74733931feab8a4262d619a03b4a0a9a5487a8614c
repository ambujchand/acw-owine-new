{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{X3zk:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"LoginPageModule\",(function(){return login_module_LoginPageModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),ionic_angular=__webpack_require__(\"TEn/\"),fesm2015_router=__webpack_require__(\"tyNb\"),tslib_es6=__webpack_require__(\"mrSG\"),add_shop_page=__webpack_require__(\"jUet\"),core=__webpack_require__(\"fXoL\"),alert_service=__webpack_require__(\"3LUQ\"),login_service=__webpack_require__(\"XNvx\"),http=__webpack_require__(\"tk/3\"),env_service=__webpack_require__(\"5zL6\");let app_service_AppService=(()=>{class AppService{constructor(http,env){this.http=http,this.env=env}isSession(){return JSON.parse(localStorage.getItem(\"user\"))}}return AppService.ɵfac=function(t){return new(t||AppService)(core.Ob(http.a),core.Ob(env_service.a))},AppService.ɵprov=core.Db({token:AppService,factory:AppService.ɵfac,providedIn:\"root\"}),AppService})();var shop_service=__webpack_require__(\"8ijX\");const routes=[{path:\"\",component:(()=>{class LoginPage{constructor(loading,formBuilder,router,loginService,platform,routerOutlet,app,modalController,shop){this.loading=loading,this.formBuilder=formBuilder,this.router=router,this.loginService=loginService,this.platform=platform,this.routerOutlet=routerOutlet,this.app=app,this.modalController=modalController,this.shop=shop,this.loginForm=this.formBuilder.group({email:[\"\",[fesm2015_forms.j.required]],password:[\"\",fesm2015_forms.j.required]}),this.ifLogin=JSON.parse(localStorage.getItem(\"user\")),this.ifShop=JSON.parse(localStorage.getItem(\"shop\")),console.log(this.ifLogin),this.platform.backButton.subscribe(()=>{this.router.navigateByUrl(\"/deshboard\")})}presentModal(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){const modal=yield this.modalController.create({component:add_shop_page.a,cssClass:\"my-custom-class\"});return yield modal.present()}))}ionViewWillEnter(){null!=this.ifLogin&&(null!=this.ifShop?this.router.navigateByUrl(\"/deshboard\"):(console.log(this.ifLogin),0==this.ifLogin.user.role||1==this.ifLogin.user.role||2==this.ifLogin.user.role?this.getShop():this.shopBelongsToUser()))}shopBelongsToUser(){this.loading.present(),this.shop.getShop().subscribe(data=>{console.log(data.data),this.loading.dismiss(),localStorage.setItem(\"shop\",JSON.stringify({id:data.data})),this.router.navigateByUrl(\"/deshboard\")},onerror=>{0==onerror.status?(this.loading.dismiss(),this.loading.presentToastWarning(\"check your internet connection.\")):500==onerror.status&&(this.loading.dismiss(),this.loading.presentToastError(\"Server error.\"))})}getShop(){this.loading.present(),this.shop.getShop().subscribe(data=>{console.log(data.data),0==data.data.length?(this.presentModal(),this.loading.dismiss()):(this.loading.dismiss(),localStorage.setItem(\"shop\",JSON.stringify({id:data.data})),this.router.navigateByUrl(\"/deshboard\"))},onerror=>{0==onerror.status?(this.loading.dismiss(),this.loading.presentToastWarning(\"check your internet connection.\")):500==onerror.status&&(this.loading.dismiss(),this.loading.presentToastError(\"Server error.\"))})}login(){this.loading.present(),this.loginService.login(this.loginForm.value.email,this.loginForm.value.password).subscribe(data=>{this.userDetails=data,console.log(data),this.userDetails.user&&(localStorage.setItem(\"user\",JSON.stringify({user:this.userDetails.user,token_type:this.userDetails.token_type,access_token:this.userDetails.access_token,sidebar:this.userDetails.sidebar})),this.app.ifLogin=JSON.parse(localStorage.getItem(\"user\")),this.loading.dismiss(),window.location.reload(),this.router.navigateByUrl(\"/\")),this.userDetails.error&&(this.loading.dismiss(),this.loading.presentToastWarning(this.userDetails.error))},onerror=>{0==onerror.status?(this.loading.presentToastWarning(\"check your internet connection.\"),this.loading.dismiss()):500==onerror.status&&(this.loading.dismiss(),this.loading.presentToastError(\"Server error.\"))})}doRefresh(event){console.log(\"Begin async operation\"),setTimeout(()=>{console.log(\"Async operation has ended\"),event.target.complete()},2e3)}ngOnInit(){}}return LoginPage.ɵfac=function(t){return new(t||LoginPage)(core.Hb(alert_service.a),core.Hb(fesm2015_forms.a),core.Hb(fesm2015_router.g),core.Hb(login_service.a),core.Hb(ionic_angular.U),core.Hb(ionic_angular.E),core.Hb(app_service_AppService),core.Hb(ionic_angular.R),core.Hb(shop_service.a))},LoginPage.ɵcmp=core.Bb({type:LoginPage,selectors:[[\"app-login\"]],decls:23,vars:3,consts:[[3,\"translucent\"],[\"padding\",\"true\"],[\"slot\",\"fixed\",3,\"ionRefresh\"],[\"pullingIcon\",\"chevron-down-circle-outline\",\"pullingText\",\"Pull to refresh\",\"refreshingSpinner\",\"circles\"],[1,\"p-0\"],[\"size\",\"2\"],[\"src\",\"assets/login.jpg\"],[2,\"padding\",\"0px\",\"border\",\"1px solid #151414\"],[3,\"formGroup\",\"ngSubmit\"],[\"type\",\"text\",\"formControlName\",\"email\",\"placeholder\",\"Email or Phone\"],[\"type\",\"password\",\"formControlName\",\"password\",\"placeholder\",\"Password\"],[\"type\",\"submit\",\"expand\",\"block\",3,\"disabled\"]],template:function(rf,ctx){1&rf&&(core.Kb(0,\"ion-header\",0),core.Kb(1,\"ion-toolbar\"),core.Kb(2,\"ion-title\"),core.hc(3,\"Login\"),core.Jb(),core.Jb(),core.Jb(),core.Kb(4,\"ion-content\",1),core.Kb(5,\"ion-refresher\",2),core.Sb(\"ionRefresh\",(function($event){return ctx.doRefresh($event)})),core.Ib(6,\"ion-refresher-content\",3),core.Jb(),core.Kb(7,\"ion-grid\",4),core.Kb(8,\"ion-row\"),core.Ib(9,\"ion-col\",5),core.Kb(10,\"ion-col\"),core.Ib(11,\"img\",6),core.Jb(),core.Ib(12,\"ion-col\",5),core.Jb(),core.Jb(),core.Kb(13,\"ion-card\"),core.Kb(14,\"ion-card-content\",7),core.Kb(15,\"form\",8),core.Sb(\"ngSubmit\",(function(){return ctx.login()})),core.Kb(16,\"ion-list\",4),core.Kb(17,\"ion-item\"),core.Ib(18,\"ion-input\",9),core.Jb(),core.Kb(19,\"ion-item\"),core.Ib(20,\"ion-input\",10),core.Jb(),core.Jb(),core.Kb(21,\"ion-button\",11),core.hc(22,\"Login\"),core.Jb(),core.Jb(),core.Jb(),core.Jb(),core.Jb()),2&rf&&(core.Xb(\"translucent\",!0),core.xb(15),core.Xb(\"formGroup\",ctx.loginForm),core.xb(6),core.Xb(\"disabled\",!ctx.loginForm.valid))},directives:[ionic_angular.m,ionic_angular.N,ionic_angular.M,ionic_angular.i,ionic_angular.C,ionic_angular.D,ionic_angular.l,ionic_angular.F,ionic_angular.h,ionic_angular.d,ionic_angular.e,fesm2015_forms.k,fesm2015_forms.h,fesm2015_forms.c,ionic_angular.w,ionic_angular.r,ionic_angular.q,ionic_angular.X,fesm2015_forms.g,fesm2015_forms.b,ionic_angular.b],styles:[\"toast-wrapper[_ngcontent-%COMP%]   toast-bottom[_ngcontent-%COMP%]{bottom:calc(8px + var(--ion-safe-area-bottom, 0px));border-radius:25px;height:25px;border-radius:2px solid red;border:1px solid red;text-align:center;font-size:12px}ion-toast[_ngcontent-%COMP%]{color:red!important}.toast-container[_ngcontent-%COMP%], toast-container[_ngcontent-%COMP%]{background:#fff!important;color:red!important}ion-toast[_ngcontent-%COMP%]{border-radius:.65rem!important;background:#fff!important}.toast-md[_ngcontent-%COMP%], toast-md[_ngcontent-%COMP%]{background:#fff!important;color:red!important}\"]}),LoginPage})()}];let login_routing_module_LoginPageRoutingModule=(()=>{class LoginPageRoutingModule{}return LoginPageRoutingModule.ɵmod=core.Fb({type:LoginPageRoutingModule}),LoginPageRoutingModule.ɵinj=core.Eb({factory:function(t){return new(t||LoginPageRoutingModule)},imports:[[fesm2015_router.i.forChild(routes)],fesm2015_router.i]}),LoginPageRoutingModule})(),login_module_LoginPageModule=(()=>{class LoginPageModule{}return LoginPageModule.ɵmod=core.Fb({type:LoginPageModule}),LoginPageModule.ɵinj=core.Eb({factory:function(t){return new(t||LoginPageModule)},imports:[[fesm2015_forms.i,fesm2015_router.i,http.b,common.b,ionic_angular.O,login_routing_module_LoginPageRoutingModule]]}),LoginPageModule})()}}]);","extractedComments":[]}